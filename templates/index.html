{% extends "base.html" %}

{% block content %}
<section class="card">
    <div class="card-header">
        <h2>Generate Speech</h2>
        <p class="card-description">Convert your text into natural sounding audio presets.</p>
    </div>
    
    <div class="card-content">
        <div class="form-group">
            <label for="text-input" class="input-label">Your Text</label>
            <textarea 
                id="text-input" 
                class="text-input" 
                placeholder="Type or paste your text here..."
                maxlength="500"
                rows="5"
            ></textarea>
            <div class="char-counter">
                <span id="char-count">0</span> / 500
            </div>
        </div>

        <div class="form-group">
            <label for="voice-select" class="input-label">Voice Preset</label>
            <select id="voice-select" class="voice-select">
                <option value="">Loading voices...</option>
            </select>
        </div>

        <div class="button-group">
            <button id="synthesize-btn" class="btn btn-primary">
                Generate Speech
            </button>
            <button id="clear-btn" class="btn btn-outline">
                Clear
            </button>
        </div>
    </div>
</section>

<div id="status-section" style="display: none; margin-bottom: 1.5rem;">
    <div id="status-message" class="status-message"></div>
</div>

<div id="loading-spinner" class="loading-container" style="display: none;">
    <div class="spinner"></div>
    <p>Processing audio...</p>
</div>

<section id="audio-section" class="card audio-card" style="display: none;">
    <div class="card-header">
        <h2>Generated Audio</h2>
    </div>
    <div class="card-content">
        <audio id="audio-player" class="audio-player" controls></audio>
        <div id="audio-info" class="audio-info"></div>
        <button id="download-btn" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
            Download WAV
        </button>
    </div>
</section>

<section class="card">
    <div class="card-header">
        <h2>Quick Examples</h2>
    </div>
    <div class="card-content">
        <div class="example-grid">
            <button class="btn-example" data-text="Hello! This is a test of the text-to-speech system.">Simple Greeting</button>
            <button class="btn-example" data-text="Artificial intelligence is transforming how we interact with technology.">AI Technology</button>
            <button class="btn-example" data-text="Accessibility is not a feature, it's a fundamental human right.">Accessibility</button>
        </div>
    </div>
</section>

<div class="features-grid">
    <div class="feature-item">
        <div class="feature-icon">âš¡</div>
        <h3>Fast</h3>
        <p>Real-time processing with Bark.</p>
    </div>
    <div class="feature-item">
        <div class="feature-icon">ðŸŽ­</div>
        <h3>Diverse</h3>
        <p>Multiple voice styles available.</p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
async function loadVoices() {
    try {
        const response = await fetch('/api/voices');
        const data = await response.json();
        if (data.success && data.voices) {
            const voiceSelect = document.getElementById('voice-select');
            voiceSelect.innerHTML = '';
            data.voices.forEach(voice => {
                const option = document.createElement('option');
                option.value = voice.id || '';
                option.textContent = voice.name;
                voiceSelect.appendChild(option);
            });
        }
    } catch (e) {
        document.getElementById('voice-select').innerHTML = '<option value="">Default Voice</option>';
    }
}
document.addEventListener('DOMContentLoaded', loadVoices);
</script>
{% endblock %}